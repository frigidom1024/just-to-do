# TodoList åç«¯æœåŠ¡

> åŸºäº DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰æ¶æ„çš„å¾…åŠäº‹é¡¹åç«¯æœåŠ¡

## æ¦‚è¿°

ä¸€ä¸ªé‡‡ç”¨æ•´æ´æ¶æ„ï¼ˆClean Architectureï¼‰å’Œ DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰çš„åç«¯æœåŠ¡ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’Œå¾…åŠäº‹é¡¹ç®¡ç†åŠŸèƒ½ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **ç”¨æˆ·ç®¡ç†**ï¼šæ³¨å†Œã€ç™»å½•ã€JWT è®¤è¯ã€æƒé™æ§åˆ¶
- **å¾…åŠäº‹é¡¹ç®¡ç†**ï¼šCRUD æ“ä½œã€ä¼˜å…ˆçº§è®¾ç½®ã€æ—¶é—´ç®¡ç†
- **æ¯æ—¥ç¬”è®°**ï¼šæ¯æ—¥ç¬”è®°ä¹¦å†™å’Œç®¡ç†
- **Markdown å¯¼å‡º**ï¼šæ”¯æŒå¯¼å‡ºä¸º Markdown æ ¼å¼
- **å®‰å…¨è®¤è¯**ï¼šJWT Tokenã€bcrypt å¯†ç åŠ å¯†ã€è§’è‰²æƒé™

## æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| **è¯­è¨€** | Go | 1.25.5+ |
| **Webæ¡†æ¶** | net/http | æ ‡å‡†åº“ |
| **æ•°æ®åº“** | MySQL | 8.0+ |
| **ORM** | sqlx | - |
| **é…ç½®ç®¡ç†** | Viper | - |
| **è®¤è¯æˆæƒ** | JWT | golang-jwt/jwt/v5 |
| **å¯†ç åŠ å¯†** | bcrypt | golang.org/x/crypto |
| **æ¶æ„æ¨¡å¼** | DDD + Clean Arch | - |
| **æ—¥å¿—** | ç»“æ„åŒ–æ—¥å¿— | slog |
| **å®¹å™¨åŒ–** | Docker | - |

## é¡¹ç›®ç»“æ„

```
todo-service/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go              # ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ src/internal/
â”‚   â”œâ”€â”€ interfaces/              # æ¥å£å±‚ï¼ˆAdapterï¼‰
â”‚   â”‚   â”œâ”€â”€ http/
â”‚   â”‚   â”‚   â”œâ”€â”€ handler/         # HTTP å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶ï¼ˆè®¤è¯ç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ request/         # è¯·æ±‚ DTO
â”‚   â”‚   â”‚   â””â”€â”€ response/        # å“åº” DTO
â”‚   â”‚   â”œâ”€â”€ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡ â­ æ–°å¢
â”‚   â”‚   â”‚   â””â”€â”€ user_dto.go      # ç”¨æˆ· DTO
â”‚   â”‚   â””â”€â”€ do/                  # æ•°æ®å¯¹è±¡ï¼ˆData Objectï¼‰
â”‚   â”‚       â”œâ”€â”€ user.go
â”‚   â”‚       â”œâ”€â”€ daily_note.go
â”‚   â”‚       â”œâ”€â”€ todo.go
â”‚   â”‚       â””â”€â”€ note.go
â”‚   â”‚
â”‚   â”œâ”€â”€ application/            # åº”ç”¨å±‚ â­ æ–°å¢
â”‚   â”‚   â””â”€â”€ user/                # ç”¨æˆ·åº”ç”¨æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ user_app.go      # ç”¨æˆ·ç”¨ä¾‹ç¼–æ’
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                  # é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ user/                # ç”¨æˆ·é¢†åŸŸ
â”‚   â”‚   â”‚   â”œâ”€â”€ entity.go        # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ value_objects.go # å€¼å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ errors.go        # é¢†åŸŸé”™è¯¯
â”‚   â”‚   â”‚   â”œâ”€â”€ repository.go    # ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ service.go       # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ hasher.go        # å¯†ç å“ˆå¸Œæ¥å£
â”‚   â”‚   â”œâ”€â”€ todo/                # å¾…åŠäº‹é¡¹é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ daily_note/          # æ¯æ—¥ç¬”è®°é¢†åŸŸ
â”‚   â”‚   â””â”€â”€ common/              # é€šç”¨é¢†åŸŸæ¦‚å¿µ
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/          # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ persistence/         # æ•°æ®æŒä¹…åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ mysql/
â”‚   â”‚   â”‚       â”œâ”€â”€ db.go         # æ•°æ®åº“å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â””â”€â”€ user_repository.go  # ç”¨æˆ·ä»“å‚¨å®ç°
â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ db_config.go     # æ•°æ®åº“é…ç½®
â”‚   â”‚   â”‚   â””â”€â”€ jwt_config.go    # JWT é…ç½®
â”‚   â”‚   â””â”€â”€ hasher/              # å¯†ç å“ˆå¸Œå®ç°
â”‚   â”‚
â”‚   â””â”€â”€ pkg/                     # å†…éƒ¨åŒ…
â”‚       â”œâ”€â”€ logger/              # æ—¥å¿—ç»„ä»¶
â”‚       â”œâ”€â”€ auth/                # è®¤è¯å·¥å…·
â”‚       â”‚   â”œâ”€â”€ hasher.go        # bcrypt å“ˆå¸Œ
â”‚       â”‚   â””â”€â”€ token.go         # JWT Token å·¥å…·
â”‚       â””â”€â”€ context/             # ä¸Šä¸‹æ–‡å·¥å…· â­ æ–°å¢
â”‚           â””â”€â”€ user.go         # ç”¨æˆ·ä¸Šä¸‹æ–‡è·å–
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â”œâ”€â”€ JWT_AUTHENTICATION.md    # JWT è®¤è¯è¯´æ˜
â”‚   â”œâ”€â”€ JWT_QUICK_START.md       # JWT å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ DTO_ARCHITECTURE.md      # DTO æ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ DTO_LOCATION_REFACTOR.md # DTO é‡æ„è¯´æ˜
â”‚   â””â”€â”€ APPLICATION_LAYER_IMPROVEMENTS.md  # åº”ç”¨å±‚ä¼˜åŒ–
â”‚
â”œâ”€â”€ deployments/                 # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ db/                       # æ•°æ®åº“éƒ¨ç½²
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

## æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     HTTP Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Handler (å¤„ç†å™¨)                                  â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¥æ”¶ HTTP è¯·æ±‚                               â”‚  â”‚
â”‚  â”‚    â”œâ”€ è°ƒç”¨åº”ç”¨æœåŠ¡                                 â”‚  â”‚
â”‚  â”‚    â””â”€ è¿”å› HTTP å“åº”                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Middleware (ä¸­é—´ä»¶)                               â”‚  â”‚
â”‚  â”‚    â”œâ”€ JWT è®¤è¯                                      â”‚  â”‚
â”‚  â”‚    â”œâ”€ æƒé™éªŒè¯                                      â”‚  â”‚
â”‚  â”‚    â””â”€ æ—¥å¿—è®°å½•                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Application Layer (åº”ç”¨å±‚)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Application Service (åº”ç”¨æœåŠ¡)                     â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¥æ”¶åŸå§‹æ•°æ® (string)                          â”‚  â”‚
â”‚  â”‚    â”œâ”€ å‚æ•°éªŒè¯ï¼ˆå€¼å¯¹è±¡åˆ›å»ºï¼‰                         â”‚  â”‚
â”‚  â”‚    â”œâ”€ è°ƒç”¨é¢†åŸŸæœåŠ¡                                   â”‚  â”‚
â”‚  â”‚    â”œâ”€ Entity â†’ DTO è½¬æ¢                              â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸šåŠ¡æ—¥å¿—è®°å½•                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Layer (é¢†åŸŸå±‚)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Value Objects (å€¼å¯¹è±¡)                            â”‚  â”‚
â”‚  â”‚    â”œâ”€ Username, Email, Password                     â”‚  â”‚
â”‚  â”‚    â””â”€ è‡ªéªŒè¯é€»è¾‘                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Entity (å®ä½“)                                     â”‚  â”‚
â”‚  â”‚    â”œâ”€ ä¸šåŠ¡è¡Œä¸ºæ–¹æ³•                                   â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸åŒ…å«åŸºç¡€è®¾æ–½ä¾èµ–                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Domain Service (é¢†åŸŸæœåŠ¡)                         â”‚  â”‚
â”‚  â”‚    â”œâ”€ è·¨å®ä½“çš„ä¸šåŠ¡é€»è¾‘                              â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸šåŠ¡è§„åˆ™å®ç°                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Repository Interface (ä»“å‚¨æ¥å£)                   â”‚  â”‚
â”‚  â”‚    â””â”€ å®šä¹‰æ•°æ®è®¿é—®å¥‘çº¦                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Repository Implementation (ä»“å‚¨å®ç°)              â”‚  â”‚
â”‚  â”‚    â””â”€ MySQL/PostgreSQL/NoSQL...                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  External Services (å¤–éƒ¨æœåŠ¡)                      â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ–‡ä»¶å­˜å‚¨                                       â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¶ˆæ¯é˜Ÿåˆ—                                       â”‚  â”‚
â”‚  â”‚    â””â”€ ç¬¬ä¸‰æ–¹ API                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµè½¬

```
HTTP Request (JSON)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler Layer                                    â”‚
â”‚  request.RegisterUserRequest                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ åŸå§‹å€¼ (string)
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Application Layer                                â”‚
â”‚  1. NewUsername(username) â†’ Username VO        â”‚
â”‚  2. NewEmail(email) â†’ Email VO                  â”‚
â”‚  3. NewPassword(password) â†’ Password VO        â”‚
â”‚  4. userService.RegisterUser(...)              â”‚
â”‚  5. entity â†’ dto.ToUserDTO(entity)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ DTO (*dto.UserDTO)
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler Layer (å“åº”è½¬æ¢)                         â”‚
â”‚  dto.UserDTO â†’ response.UserResponse            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
      HTTP Response (JSON)
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.25.5+
- MySQL 8.0+
- Docker (å¯é€‰)

### å®‰è£…ä¸è¿è¡Œ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd todo-service

# 2. å®‰è£…ä¾èµ–
go mod download

# 3. é…ç½®æ•°æ®åº“
cp config/config.example.yaml config/config.yaml
# ç¼–è¾‘ config.yaml ä¸­çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯

# 4. è¿è¡Œæ•°æ®åº“è¿ç§»
go run scripts/migrate.go

# 5. å¯åŠ¨æœåŠ¡
go run cmd/server/main.go

# æœåŠ¡å°†åœ¨ http://localhost:8080 å¯åŠ¨
```

### Docker éƒ¨ç½²

```bash
# ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰
docker-compose up -d

# æœåŠ¡å°†åœ¨ http://localhost:8080 å¯ç”¨
```

## API æ–‡æ¡£

### è®¤è¯æ¥å£

#### 1. ç”¨æˆ·æ³¨å†Œ

```http
POST /api/users/register
Content-Type: application/json

{
  "username": "johndoe",
  "email": "john@example.com",
  "password": "SecurePass123!"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ok",
  "data": {
    "id": 1,
    "username": "johndoe",
    "email": "john@example.com",
    "avatar_url": "",
    "status": "active",
    "created_at": "2024-01-17T10:30:00Z",
    "updated_at": "2024-01-17T10:30:00Z"
  }
}
```

#### 2. ç”¨æˆ·ç™»å½•

```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "john@example.com",
  "password": "SecurePass123!"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ok",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "johndoe",
      "email": "john@example.com",
      "avatar_url": "",
      "status": "active"
    }
  }
}
```

### å—ä¿æŠ¤çš„æ¥å£

éœ€è¦è®¤è¯çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Tokenï¼š

```http
GET /api/users/me
Authorization: Bearer <token>
```

**è®¤è¯ä¸­é—´ä»¶ï¼š**
- `AuthMiddleware` - å¼ºåˆ¶è®¤è¯
- `OptionalAuthMiddleware` - å¯é€‰è®¤è¯
- `RequireRole(role)` - è§’è‰²éªŒè¯

## è®¤è¯æœºåˆ¶

### JWT Token å·¥å…·

é¡¹ç›®æä¾›äº†å®Œæ•´çš„ JWT Token ç®¡ç†å·¥å…·ï¼š

**ä½ç½®ï¼š** [`internal/pkg/auth/token.go`](internal/pkg/auth/token.go)

**åŠŸèƒ½ï¼š**
- âœ… `GenerateToken(userID, username, role)` - ç”Ÿæˆ Token
- âœ… `ParseToken(token)` - è§£æå’ŒéªŒè¯ Token
- âœ… `RefreshToken(token)` - åˆ·æ–° Token

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import "todolist/internal/pkg/auth"

// ç”Ÿæˆ Token
tokenTool := auth.NewTokenTool(cfg)
token, err := tokenTool.GenerateToken(userID, username, "user")
```

### è®¤è¯ä¸­é—´ä»¶

**ä½ç½®ï¼š** [`internal/interfaces/http/middleware/auth.go`](internal/interfaces/http/middleware/auth.go)

**ä¸­é—´ä»¶ç±»å‹ï¼š**

| ä¸­é—´ä»¶ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|--------|------|---------|
| `Authenticate` | å¼ºåˆ¶è®¤è¯ï¼Œå¿…é¡»æä¾›æœ‰æ•ˆ Token | ç”¨æˆ·ä¿¡æ¯ã€ä¿®æ”¹æ“ä½œ |
| `OptionalAuthenticate` | å¯é€‰è®¤è¯ï¼Œå¯ä»¥åŒ¿åè®¿é—® | å…¬å¼€ä¿¡æ¯æŸ¥çœ‹ |
| `RequireRole(role)` | è§’è‰²éªŒè¯ | ç®¡ç†å‘˜æ¥å£ |

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import (
    "todolist/internal/interfaces/http/middleware"
    appauth "todolist/internal/pkg/auth"
)

// åˆå§‹åŒ–
cfg, _ := config.GetJWTConfig()
tokenTool := appauth.NewTokenTool(cfg)
auth := middleware.NewAuthMiddleware(tokenTool)

// å—ä¿æŠ¤çš„è·¯ç”±
mux.Handle("/api/users/me",
    auth.Authenticate(handler.Wrap(GetCurrentUserHandler)))

// ç®¡ç†å‘˜è·¯ç”±
mux.Handle("/api/admin/users",
    auth.Authenticate(
        auth.RequireRole("admin")(
            handler.Wrap(ListUsersHandler))))
```

### ä¸Šä¸‹æ–‡å·¥å…·

**ä½ç½®ï¼š** [`internal/pkg/context/user.go`](internal/pkg/context/user.go)

**åŠŸèƒ½ï¼š**
- âœ… `GetUserID(ctx)` - è·å–å½“å‰ç”¨æˆ· ID
- âœ… `GetUsername(ctx)` - è·å–å½“å‰ç”¨æˆ·å
- âœ… `GetRole(ctx)` - è·å–ç”¨æˆ·è§’è‰²
- âœ… `HasRole(ctx, role)` - æ£€æŸ¥æ˜¯å¦æœ‰æŒ‡å®šè§’è‰²

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import "todolist/internal/pkg/contextx"

func GetCurrentUserHandler(ctx context.Context, req Empty) (UserResponse, error) {
    // è·å–å½“å‰ç”¨æˆ·
    userID, err := contextx.GetUserID(ctx)
    if err != nil {
        return UserResponse{}, err
    }

    // æ£€æŸ¥æƒé™
    if !contextx.HasRole(ctx, "admin") {
        return UserResponse{}, ErrPermissionDenied
    }

    // ä¸šåŠ¡é€»è¾‘
    return userService.GetByID(ctx, userID)
}
```

è¯¦ç»†æ–‡æ¡£ï¼š[JWT_AUTHENTICATION.md](docs/JWT_AUTHENTICATION.md)

## æ¶æ„è®¾è®¡æ–‡æ¡£

é¡¹ç›®åŒ…å«è¯¦ç»†çš„æ¶æ„è®¾è®¡æ–‡æ¡£ï¼š

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [JWT_AUTHENTICATION.md](docs/JWT_AUTHENTICATION.md) | JWT è®¤è¯æœºåˆ¶å®Œæ•´æŒ‡å— |
| [JWT_QUICK_START.md](docs/JWT_QUICK_START.md) | JWT å¿«é€Ÿå‚è€ƒ |
| [DTO_ARCHITECTURE.md](docs/DTO_ARCHITECTURE.md) | DTO æ¶æ„è®¾è®¡ |
| [DTO_LOCATION_REFACTOR.md](docs/DTO_LOCATION_REFACTOR.md) | DTO é‡æ„è¯´æ˜ |
| [APPLICATION_LAYER_IMPROVEMENTS.md](docs/APPLICATION_LAYER_IMPROVEMENTS.md) | åº”ç”¨å±‚ä¼˜åŒ– |

## å¼€å‘è§„èŒƒ

### æ—¥å¿—è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—ï¼Œéµå¾ª [logger/CONVENTIONS.md](internal/pkg/logger/CONVENTIONS.md)ï¼š

```go
import applogger "todolist/internal/pkg/logger"

// è®°å½•æ—¥å¿—
applogger.Info("ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
    applogger.Int64("user_id", userID),
    applogger.String("username", username),
    applogger.Duration("duration_ms", duration))

// å¸¦ä¸Šä¸‹æ–‡çš„æ—¥å¿—
applogger.InfoContext(ctx, "å¼€å§‹å¤„ç†è¯·æ±‚",
    applogger.String("path", r.URL.Path))
```

### DDD è®¾è®¡åŸåˆ™

1. **é¢†åŸŸå±‚**ï¼šçº¯ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–åŸºç¡€è®¾æ–½
2. **åº”ç”¨å±‚**ï¼šç”¨ä¾‹ç¼–æ’ï¼Œæ¥æ”¶åŸå§‹å€¼ï¼Œè¿”å› DTO
3. **æ¥å£å±‚**ï¼šHTTP å¤„ç†ï¼Œä½¿ç”¨åº”ç”¨å±‚æœåŠ¡
4. **åŸºç¡€è®¾æ–½å±‚**ï¼šå®ç°ä»“å‚¨æ¥å£ï¼Œå¯¹æ¥å¤–éƒ¨æœåŠ¡

### åˆ†å±‚ä¾èµ–

```
Handler â†’ Application â†’ Domain â†’ Infrastructure
  â†“          â†“           â†“          â†“
 HTTP       Use Case    Business   Data Access
```

**ä¾èµ–æ–¹å‘**ï¼šå¤–å±‚ä¾èµ–å†…å±‚ï¼Œå†…å±‚ä¸ä¾èµ–å¤–å±‚

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒå®ä½“

- **usersï¼ˆç”¨æˆ·ï¼‰**ï¼šè´¦æˆ·ä¿¡æ¯ã€è®¤è¯çŠ¶æ€
- **daily_notesï¼ˆæ¯æ—¥ç¬”è®°ï¼‰**ï¼šç”¨æˆ·ç¬”è®°
- **todosï¼ˆå¾…åŠäº‹é¡¹ï¼‰**ï¼šå…³è”ç¬”è®°çš„å¾…åŠ
- **notesï¼ˆå¤‡æ³¨ï¼‰**ï¼šå¾…åŠäº‹é¡¹çš„å¤‡æ³¨

**ER å›¾ï¼š** [docs/arch/er.puml](docs/arch/er.puml)

### æ•°æ®åº“è¿ç§»

```bash
# è¿è¡Œè¿ç§»
go run scripts/migrate.go

# æŸ¥çœ‹è¿ç§»è„šæœ¬
ls internal/infrastructure/persistence/migrations/
```

## å¼€å‘çŠ¶æ€

### å·²å®Œæˆ âœ…

- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] DDD åˆ†å±‚æ¶æ„
- [x] HTTP åŸºç¡€æ¡†æ¶
- [x] å¥åº·æ£€æŸ¥æ¥å£
- [x] ç»“æ„åŒ–æ—¥å¿—ç»„ä»¶
- [x] ç”¨æˆ·é¢†åŸŸæ¨¡å‹
  - [x] ç”¨æˆ·å®ä½“ï¼ˆEntityï¼‰
  - [x] å€¼å¯¹è±¡ï¼ˆEmail, Password, Usernameï¼‰
  - [x] é¢†åŸŸé”™è¯¯å®šä¹‰
  - [x] é¢†åŸŸæœåŠ¡ï¼ˆUserServiceï¼‰
  - [x] ä»“å‚¨æ¥å£ï¼ˆRepositoryï¼‰
- [x] ç”¨æˆ·ä»“å‚¨å®ç°ï¼ˆMySQLï¼‰
- [x] å¯†ç å“ˆå¸Œï¼ˆbcryptï¼‰
- [x] JWT Token å·¥å…·
- [x] è®¤è¯ä¸­é—´ä»¶
- [x] ä¸Šä¸‹æ–‡å·¥å…·
- [x] åº”ç”¨å±‚æœåŠ¡ï¼ˆApplicationï¼‰
- [x] DTO æ¶æ„
- [x] æ•°æ®åº“è¿æ¥å’Œé…ç½®
- [x] ç”¨æˆ·æ³¨å†Œ/ç™»å½•æ¥å£

### è¿›è¡Œä¸­ ğŸš§

- [ ] å¾…åŠäº‹é¡¹é¢†åŸŸæ¨¡å‹
- [ ] æ¯æ—¥ç¬”è®°é¢†åŸŸæ¨¡å‹
- [ ] Markdown å¯¼å‡ºåŠŸèƒ½
- [ ] å•å…ƒæµ‹è¯•
- [ ] API æ–‡æ¡£å®Œå–„

### å¾…è§„åˆ’ ğŸ“‹

- [ ] Docker éƒ¨ç½²ä¼˜åŒ–
- [ ] CI/CD Pipeline
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç›‘æ§å’Œå‘Šè­¦
- [ ] é“¾è·¯è¿½è¸ª

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/domain/user/...

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
go test -cover ./...
```

## é…ç½®

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `SERVER_PORT` | æœåŠ¡ç«¯å£ | 8080 |
| `DB_HOST` | æ•°æ®åº“ä¸»æœº | localhost |
| `DB_PORT` | æ•°æ®åº“ç«¯å£ | 3306 |
| `DB_NAME` | æ•°æ®åº“åç§° | todolist |
| `DB_USER` | æ•°æ®åº“ç”¨æˆ· | root |
| `DB_PASSWORD` | æ•°æ®åº“å¯†ç  | - |
| `JWT_SECRET` | JWT å¯†é’¥ | - |
| `JWT_EXPIRATION` | Token è¿‡æœŸæ—¶é—´ | 24h |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | info |
| `LOG_FORMAT` | æ—¥å¿—æ ¼å¼ | json |

### é…ç½®æ–‡ä»¶

```yaml
# config/config.yaml
server:
  port: 8080

database:
  host: localhost
  port: 3306
  name: todolist
  user: root
  password: ""

jwt:
  secret_key: "your-secret-key-at-least-32-characters"
  expire_duration: 24h

logger:
  level: info
  format: json
  add_source: false
```

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•æ·»åŠ æ–°çš„æ¥å£ï¼Ÿ

```go
// 1. åœ¨ handler ä¸­å®šä¹‰å¤„ç†å™¨
func NewTodoHandler(ctx context.Context, req request.CreateTodoRequest) (response.TodoResponse, error) {
    return todoAppService.CreateTodo(ctx, req.Title, req.Content)
}

// 2. åœ¨ routes.go ä¸­æ³¨å†Œè·¯ç”±
mux.Handle("POST /api/todos",
    auth.Authenticate(handler.Wrap(NewTodoHandler)))
```

### 2. å¦‚ä½•ä½¿ç”¨ JWT è®¤è¯ï¼Ÿ

```go
// 1. ç™»å½•è·å– Token
POST /api/auth/login
{
  "email": "user@example.com",
  "password": "password"
}

// 2. ä½¿ç”¨ Token è®¿é—®å—ä¿æŠ¤æ¥å£
GET /api/users/me
Headers: Authorization: Bearer <token>
```

### 3. å¦‚ä½•è·å–å½“å‰ç”¨æˆ·ï¼Ÿ

```go
import "todolist/internal/pkg/contextx"

func Handler(ctx context.Context) {
    userID := contextx.MustGetUserID(ctx)
    username := contextx.MustGetUsername(ctx)
    // ...
}
```

### 4. å¦‚ä½•æ·»åŠ è§’è‰²æƒé™ï¼Ÿ

```go
// åœ¨è·¯ç”±ä¸­ä½¿ç”¨ RequireRole ä¸­é—´ä»¶
mux.Handle("/api/admin/users",
    auth.Authenticate(
        auth.RequireRole("admin")(
            handler.Wrap(AdminHandler))))

// åœ¨ Handler ä¸­æ£€æŸ¥
if !contextx.HasRole(ctx, "admin") {
    return errors.New("permission denied")
}
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## è®¸å¯è¯

[MIT License](LICENSE)

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€ï¼š[GitHub Repository]
- é—®é¢˜åé¦ˆï¼š[Issues]

---

**æœ€åæ›´æ–°ï¼š** 2024-01-17
**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 2.0
