# TodoList åç«¯æœåŠ¡

> åŸºäº DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰æ¶æ„çš„å¾…åŠäº‹é¡¹åç«¯æœåŠ¡

## æ¦‚è¿°

ä¸€ä¸ªé‡‡ç”¨æ•´æ´æ¶æ„ï¼ˆClean Architectureï¼‰å’Œ DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰çš„åç«¯æœåŠ¡ï¼Œæä¾›å®Œæ•´çš„ç”¨æˆ·è®¤è¯å’Œå¾…åŠäº‹é¡¹ç®¡ç†åŠŸèƒ½ã€‚

### æ ¸å¿ƒåŠŸèƒ½

- **ç”¨æˆ·ç®¡ç†**ï¼šæ³¨å†Œã€ç™»å½•ã€JWT è®¤è¯ã€æƒé™æ§åˆ¶
- **å¾…åŠäº‹é¡¹ç®¡ç†**ï¼šCRUD æ“ä½œã€ä¼˜å…ˆçº§è®¾ç½®ã€æ—¶é—´ç®¡ç†
- **æ¯æ—¥ç¬”è®°**ï¼šæ¯æ—¥ç¬”è®°ä¹¦å†™å’Œç®¡ç†
- **Markdown å¯¼å‡º**ï¼šæ”¯æŒå¯¼å‡ºä¸º Markdown æ ¼å¼
- **å®‰å…¨è®¤è¯**ï¼šJWT Tokenã€bcrypt å¯†ç åŠ å¯†ã€è§’è‰²æƒé™

## æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|------|
| **è¯­è¨€** | Go | 1.25.5+ | - |
| **Webæ¡†æ¶** | net/http | æ ‡å‡†åº“ | - |
| **æ•°æ®åº“** | MySQL | 8.0+ | - |
| **ORM** | sqlx | - | - |
| **é…ç½®ç®¡ç†** | ç¯å¢ƒå˜é‡ | - | - |
| **è®¤è¯æˆæƒ** | JWT | golang-jwt/jwt/v5, go-jwt-middleware | ç¬¬ä¸‰æ–¹åº“ â­ |
| **å¯†ç åŠ å¯†** | bcrypt | golang.org/x/crypto | - |
| **æ¶æ„æ¨¡å¼** | DDD + Clean Arch | - | - |
| **æ—¥å¿—** | ç»“æ„åŒ–æ—¥å¿— | slog | - |
| **å®¹å™¨åŒ–** | Docker | - | - |

## é¡¹ç›®ç»“æ„

```
todo-service/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go              # ç¨‹åºå…¥å£
â”‚
â”œâ”€â”€ src/internal/
â”‚   â”œâ”€â”€ interfaces/              # æ¥å£å±‚ï¼ˆAdapterï¼‰
â”‚   â”‚   â”œâ”€â”€ http/
â”‚   â”‚   â”‚   â”œâ”€â”€ handler/         # HTTP å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶ï¼ˆè®¤è¯ç­‰ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ request/         # è¯·æ±‚ DTO
â”‚   â”‚   â”‚   â””â”€â”€ response/        # å“åº” DTO
â”‚   â”‚   â”œâ”€â”€ dto/                 # æ•°æ®ä¼ è¾“å¯¹è±¡ â­ æ–°å¢
â”‚   â”‚   â”‚   â””â”€â”€ user_dto.go      # ç”¨æˆ· DTO
â”‚   â”‚   â””â”€â”€ do/                  # æ•°æ®å¯¹è±¡ï¼ˆData Objectï¼‰
â”‚   â”‚       â”œâ”€â”€ user.go
â”‚   â”‚       â”œâ”€â”€ daily_note.go
â”‚   â”‚       â”œâ”€â”€ todo.go
â”‚   â”‚       â””â”€â”€ note.go
â”‚   â”‚
â”‚   â”œâ”€â”€ application/            # åº”ç”¨å±‚ â­ æ–°å¢
â”‚   â”‚   â””â”€â”€ user/                # ç”¨æˆ·åº”ç”¨æœåŠ¡
â”‚   â”‚       â”œâ”€â”€ user_app.go      # ç”¨æˆ·ç”¨ä¾‹ç¼–æ’
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”‚
â”‚   â”œâ”€â”€ domain/                  # é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒï¼‰
â”‚   â”‚   â”œâ”€â”€ user/                # ç”¨æˆ·é¢†åŸŸ
â”‚   â”‚   â”‚   â”œâ”€â”€ entity.go        # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ value_objects.go # å€¼å¯¹è±¡
â”‚   â”‚   â”‚   â”œâ”€â”€ errors.go        # é¢†åŸŸé”™è¯¯
â”‚   â”‚   â”‚   â”œâ”€â”€ repository.go    # ä»“å‚¨æ¥å£
â”‚   â”‚   â”‚   â”œâ”€â”€ service.go       # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ hasher.go        # å¯†ç å“ˆå¸Œæ¥å£
â”‚   â”‚   â”œâ”€â”€ todo/                # å¾…åŠäº‹é¡¹é¢†åŸŸ
â”‚   â”‚   â”œâ”€â”€ daily_note/          # æ¯æ—¥ç¬”è®°é¢†åŸŸ
â”‚   â”‚   â””â”€â”€ common/              # é€šç”¨é¢†åŸŸæ¦‚å¿µ
â”‚   â”‚
â”‚   â”œâ”€â”€ infrastructure/          # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ persistence/         # æ•°æ®æŒä¹…åŒ–
â”‚   â”‚   â”‚   â””â”€â”€ mysql/
â”‚   â”‚   â”‚       â”œâ”€â”€ db.go         # æ•°æ®åº“å®¢æˆ·ç«¯
â”‚   â”‚   â”‚       â””â”€â”€ user_repository.go  # ç”¨æˆ·ä»“å‚¨å®ç°
â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ db_config.go     # æ•°æ®åº“é…ç½®ï¼ˆç¯å¢ƒå˜é‡ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ env.go           # ç¯å¢ƒå˜é‡è¾…åŠ©å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ jwt_config.go    # JWT é…ç½®ï¼ˆç¯å¢ƒå˜é‡ï¼‰
â”‚   â”‚   â””â”€â”€ hasher/              # å¯†ç å“ˆå¸Œå®ç°
â”‚   â”‚
â”‚   â””â”€â”€ pkg/                     # å†…éƒ¨åŒ…
â”‚       â”œâ”€â”€ logger/              # æ—¥å¿—ç»„ä»¶
â”‚       â”œâ”€â”€ domainerr/           # é¢†åŸŸé”™è¯¯ç±»å‹ â­ æ–°å¢
â”‚       â””â”€â”€ auth/                # è®¤è¯å·¥å…·
â”‚           â”œâ”€â”€ hasher.go        # bcrypt å“ˆå¸Œ
â”‚           â””â”€â”€ token.go         # JWT Token å·¥å…·
â”‚
â”œâ”€â”€ src/internal/routes/          # è·¯ç”±æ³¨å†Œ â­ æ–°å¢
â”‚   â”œâ”€â”€ user_routes.go           # ç”¨æˆ·è·¯ç”±
â”‚   â”œâ”€â”€ health_routes.go         # å¥åº·æ£€æŸ¥è·¯ç”±
â”‚   â””â”€â”€ daily_note_routes.go     # æ¯æ—¥ç¬”è®°è·¯ç”±
â”‚
â”œâ”€â”€ docs/                        # æ–‡æ¡£
â”‚   â”œâ”€â”€ JWT_AUTHENTICATION.md    # JWT è®¤è¯è¯´æ˜
â”‚   â”œâ”€â”€ JWT_QUICK_START.md       # JWT å¿«é€Ÿå¼€å§‹
â”‚   â”œâ”€â”€ DTO_ARCHITECTURE.md      # DTO æ¶æ„è®¾è®¡
â”‚   â”œâ”€â”€ DTO_LOCATION_REFACTOR.md # DTO é‡æ„è¯´æ˜
â”‚   â””â”€â”€ APPLICATION_LAYER_IMPROVEMENTS.md  # åº”ç”¨å±‚ä¼˜åŒ–
â”‚
â”œâ”€â”€ CONVENTIONS.md                # é¡¹ç›®å¼€å‘è§„èŒƒ â­ æ–°å¢
â”‚
â”œâ”€â”€ deployments/                 # éƒ¨ç½²é…ç½®
â”‚   â”œâ”€â”€ db/                       # æ•°æ®åº“éƒ¨ç½²
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

## æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     HTTP Layer                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Handler (å¤„ç†å™¨)                                  â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¥æ”¶ HTTP è¯·æ±‚                               â”‚  â”‚
â”‚  â”‚    â”œâ”€ è°ƒç”¨åº”ç”¨æœåŠ¡                                 â”‚  â”‚
â”‚  â”‚    â””â”€ è¿”å› HTTP å“åº”                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Middleware (ä¸­é—´ä»¶)                               â”‚  â”‚
â”‚  â”‚    â”œâ”€ JWT è®¤è¯                                      â”‚  â”‚
â”‚  â”‚    â”œâ”€ æƒé™éªŒè¯                                      â”‚  â”‚
â”‚  â”‚    â””â”€ æ—¥å¿—è®°å½•                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Application Layer (åº”ç”¨å±‚)              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Application Service (åº”ç”¨æœåŠ¡)                     â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¥æ”¶åŸå§‹æ•°æ® (string)                          â”‚  â”‚
â”‚  â”‚    â”œâ”€ å‚æ•°éªŒè¯ï¼ˆå€¼å¯¹è±¡åˆ›å»ºï¼‰                         â”‚  â”‚
â”‚  â”‚    â”œâ”€ è°ƒç”¨é¢†åŸŸæœåŠ¡                                   â”‚  â”‚
â”‚  â”‚    â”œâ”€ Entity â†’ DTO è½¬æ¢                              â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸šåŠ¡æ—¥å¿—è®°å½•                                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Domain Layer (é¢†åŸŸå±‚)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Value Objects (å€¼å¯¹è±¡)                            â”‚  â”‚
â”‚  â”‚    â”œâ”€ Username, Email, Password                     â”‚  â”‚
â”‚  â”‚    â””â”€ è‡ªéªŒè¯é€»è¾‘                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Entity (å®ä½“)                                     â”‚  â”‚
â”‚  â”‚    â”œâ”€ ä¸šåŠ¡è¡Œä¸ºæ–¹æ³•                                   â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸åŒ…å«åŸºç¡€è®¾æ–½ä¾èµ–                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Domain Service (é¢†åŸŸæœåŠ¡)                         â”‚  â”‚
â”‚  â”‚    â”œâ”€ è·¨å®ä½“çš„ä¸šåŠ¡é€»è¾‘                              â”‚  â”‚
â”‚  â”‚    â””â”€ ä¸šåŠ¡è§„åˆ™å®ç°                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Repository Interface (ä»“å‚¨æ¥å£)                   â”‚  â”‚
â”‚  â”‚    â””â”€ å®šä¹‰æ•°æ®è®¿é—®å¥‘çº¦                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Infrastructure Layer (åŸºç¡€è®¾æ–½å±‚)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Repository Implementation (ä»“å‚¨å®ç°)              â”‚  â”‚
â”‚  â”‚    â””â”€ MySQL/PostgreSQL/NoSQL...                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  External Services (å¤–éƒ¨æœåŠ¡)                      â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ–‡ä»¶å­˜å‚¨                                       â”‚  â”‚
â”‚  â”‚    â”œâ”€ æ¶ˆæ¯é˜Ÿåˆ—                                       â”‚  â”‚
â”‚  â”‚    â””â”€ ç¬¬ä¸‰æ–¹ API                                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµè½¬

```
HTTP Request (JSON)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler Layer                                    â”‚
â”‚  request.RegisterUserRequest                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ åŸå§‹å€¼ (string)
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Application Layer                                â”‚
â”‚  1. NewUsername(username) â†’ Username VO        â”‚
â”‚  2. NewEmail(email) â†’ Email VO                  â”‚
â”‚  3. NewPassword(password) â†’ Password VO        â”‚
â”‚  4. userService.RegisterUser(...)              â”‚
â”‚  5. entity â†’ dto.ToUserDTO(entity)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚ DTO (*dto.UserDTO)
             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Handler Layer (å“åº”è½¬æ¢)                         â”‚
â”‚  dto.UserDTO â†’ response.UserResponse            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â†“
      HTTP Response (JSON)
```

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.25.5+
- MySQL 8.0+
- Docker (å¯é€‰)

### å®‰è£…ä¸è¿è¡Œ

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd todo-service

# 2. å®‰è£…ä¾èµ–
cd src
go mod download

# 3. é…ç½®ç¯å¢ƒå˜é‡
# æ–¹å¼1ï¼šä½¿ç”¨ .env æ–‡ä»¶
cat > .env << EOF
MYSQL_HOST=localhost
MYSQL_PORT=3307
MYSQL_DB=todolist
MYSQL_USER=root
MYSQL_PASSWORD=123456
JWT_SECRET_KEY=your-secret-key-at-least-32-characters-long
JWT_EXPIRE_DURATION=24h
EOF

# æ–¹å¼2ï¼šè®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡
export MYSQL_HOST=localhost
export MYSQL_PORT=3307
export MYSQL_DB=todolist
export MYSQL_USER=root
export MYSQL_PASSWORD=123456
export JWT_SECRET_KEY=your-secret-key-at-least-32-characters-long

# 4. å¯åŠ¨ MySQLï¼ˆä½¿ç”¨ Dockerï¼‰
cd ..
docker-compose up -d

# 5. å¯åŠ¨æœåŠ¡
cd src
go run cmd/server/main.go

# æœåŠ¡å°†åœ¨ http://localhost:8080 å¯åŠ¨
```

### Docker éƒ¨ç½²

```bash
# ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰
docker-compose up -d

# æœåŠ¡å°†åœ¨ http://localhost:8080 å¯ç”¨
```

## API æ–‡æ¡£

### è®¤è¯æ¥å£

#### 1. ç”¨æˆ·æ³¨å†Œ

```http
POST /api/users/register
Content-Type: application/json

{
  "username": "johndoe",
  "email": "john@example.com",
  "password": "SecurePass123!"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ok",
  "data": {
    "id": 1,
    "username": "johndoe",
    "email": "john@example.com",
    "avatar_url": "",
    "status": "active",
    "created_at": "2024-01-17T10:30:00Z",
    "updated_at": "2024-01-17T10:30:00Z"
  }
}
```

#### 2. ç”¨æˆ·ç™»å½•

```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "john@example.com",
  "password": "SecurePass123!"
}
```

**å“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ok",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "user": {
      "id": 1,
      "username": "johndoe",
      "email": "john@example.com",
      "avatar_url": "",
      "status": "active"
    }
  }
}
```

### å—ä¿æŠ¤çš„æ¥å£

éœ€è¦è®¤è¯çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Tokenï¼š

```http
GET /api/users/me
Authorization: Bearer <token>
```

**è®¤è¯ä¸­é—´ä»¶ï¼š**
- `AuthMiddleware` - å¼ºåˆ¶è®¤è¯
- `OptionalAuthMiddleware` - å¯é€‰è®¤è¯
- `RequireRole(role)` - è§’è‰²éªŒè¯

## è®¤è¯æœºåˆ¶

é¡¹ç›®ä½¿ç”¨ç¬¬ä¸‰æ–¹ JWT ä¸­é—´ä»¶åº“è¿›è¡Œè®¤è¯ç®¡ç†ï¼š

### go-jwt-middleware

**ä»“åº“åœ°å€**: [github.com/frigidom1024/go-jwt-middleware](https://github.com/frigidom1024/go-jwt-middleware)

**ç‰ˆæœ¬**: `v0.0.0-20260118082312-3aa77446d81f`

**ç‰¹æ€§**ï¼š
- âœ… æ³›å‹å®ç°çš„ JWT è®¤è¯ä¸­é—´ä»¶
- âœ… æ”¯æŒè‡ªå®šä¹‰ç”¨æˆ·ä¿¡æ¯ç±»å‹
- âœ… è‡ªåŠ¨ Token ç”Ÿæˆå’ŒéªŒè¯
- âœ… çµæ´»çš„è¿‡æœŸæ—¶é—´é…ç½®
- âœ… å•ä¾‹æ¨¡å¼ç®¡ç†è®¤è¯å®ä¾‹

**ä¸ºä»€ä¹ˆé€‰æ‹©è¿™ä¸ªåº“ï¼Ÿ**
- âœ… **æ³›å‹è®¾è®¡**ï¼šæ”¯æŒè‡ªå®šä¹‰ç”¨æˆ·ä¿¡æ¯ç±»å‹ï¼Œç±»å‹å®‰å…¨
- âœ… **å¼€ç®±å³ç”¨**ï¼šæä¾›å®Œæ•´çš„è®¤è¯ä¸­é—´ä»¶ï¼Œæ— éœ€æ‰‹åŠ¨å®ç°
- âœ… **çµæ´»é…ç½®**ï¼šæ”¯æŒåŠ¨æ€è¿‡æœŸæ—¶é—´ã€è‡ªå®šä¹‰å¯†é’¥
- âœ… **ç®€åŒ–é›†æˆ**ï¼šè‡ªåŠ¨å¤„ç† Token ç”Ÿæˆã€éªŒè¯ã€ä¸Šä¸‹æ–‡æ³¨å…¥
- âœ… **ç”Ÿäº§å°±ç»ª**ï¼šç»è¿‡å¤šä¸ªé¡¹ç›®éªŒè¯ï¼Œç¨³å®šå¯é 

### è®¤è¯ä¸­é—´ä»¶ä½¿ç”¨

**ä½ç½®ï¼š** [`src/internal/interfaces/http/middleware/auth.go`](src/internal/interfaces/http/middleware/auth.go)

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- âœ… `GetAuthMiddleware()` - è·å–è®¤è¯ä¸­é—´ä»¶å®ä¾‹ï¼ˆå•ä¾‹æ¨¡å¼ï¼‰
- âœ… `GenerateToken(dto)` - ç”Ÿæˆ JWT Token
- âœ… `GetDataFromContext(ctx)` - ä»ä¸Šä¸‹æ–‡è·å–ç”¨æˆ·ä¿¡æ¯

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import "todolist/internal/interfaces/http/middleware"
import core "github.com/frigidom1024/go-jwt-middleware/core"

// 1. è·å–è®¤è¯ä¸­é—´ä»¶å®ä¾‹
auth := middleware.GetAuthMiddleware()

// 2. åœ¨è·¯ç”±ä¸­ä½¿ç”¨
mux.Handle("/api/users/me",
    auth.Authenticate(handler.Wrap(GetCurrentUserHandler)))

// 3. åœ¨ Handler ä¸­è·å–ç”¨æˆ·ä¿¡æ¯
func Handler(ctx context.Context) {
    user, ok := middleware.GetDataFromContext(ctx)
    if !ok {
        return errors.New("unauthorized")
    }

    userID := user.UserID
    username := user.Username
    role := user.Role
    // ...
}
```

**middleware.User ç»“æ„ï¼š**
```go
type User struct {
    UserID   int64
    Username string
    Role      string
}
```

### è®¤è¯ä¸­é—´ä»¶

**ä½ç½®ï¼š** [`src/internal/interfaces/http/middleware/auth.go`](src/internal/interfaces/http/middleware/auth.go)

**æä¾›çš„ä¸­é—´ä»¶æ–¹æ³•ï¼ˆæ¥è‡ª go-jwt-middlewareï¼‰ï¼š**

| ä¸­é—´ä»¶ | è¯´æ˜ | ä½¿ç”¨åœºæ™¯ |
|--------|------|---------|
| `Authenticate` | å¼ºåˆ¶è®¤è¯ï¼Œå¿…é¡»æä¾›æœ‰æ•ˆ Token | ç”¨æˆ·ä¿¡æ¯ã€ä¿®æ”¹æ“ä½œ |
| `OptionalAuthenticate` | å¯é€‰è®¤è¯ï¼Œå¯ä»¥åŒ¿åè®¿é—® | å…¬å¼€ä¿¡æ¯æŸ¥çœ‹ |
| `RequireRole(role)` | è§’è‰²éªŒè¯ | ç®¡ç†å‘˜æ¥å£ |

**é…ç½®æ–¹å¼ï¼š**
è®¤è¯ä¸­é—´ä»¶é€šè¿‡ç¯å¢ƒå˜é‡è‡ªåŠ¨é…ç½®ï¼š
- `JWT_SECRET_KEY` - JWT å¯†é’¥ï¼ˆå¿…éœ€ï¼‰
- `JWT_EXPIRE_DURATION` - Token è¿‡æœŸæ—¶é—´ï¼ˆé»˜è®¤24hï¼‰

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import (
    "todolist/internal/interfaces/http/middleware"
)

// è·å–è®¤è¯ä¸­é—´ä»¶å®ä¾‹ï¼ˆå·²è‡ªåŠ¨é…ç½®ï¼‰
auth := middleware.GetAuthMiddleware()

// å—ä¿æŠ¤çš„è·¯ç”±
mux.Handle("/api/users/me",
    auth.Authenticate(handler.Wrap(GetCurrentUserHandler)))

// ç®¡ç†å‘˜è·¯ç”±
mux.Handle("/api/admin/users",
    auth.Authenticate(
        auth.RequireRole("admin")(
            handler.Wrap(ListUsersHandler))))
```

### ä¸Šä¸‹æ–‡å·¥å…·

**ä½ç½®ï¼š** [`src/internal/interfaces/http/middleware/auth.go`](src/internal/interfaces/http/middleware/auth.go)

**åŠŸèƒ½ï¼š**
- âœ… `GetDataFromContext(ctx)` - ä»ä¸Šä¸‹æ–‡è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆè¿”å› middleware.Userï¼‰
- âœ… `GenerateToken(dto)` - ç”Ÿæˆ JWT Token
- âœ… `GetAuthMiddleware()` - è·å–è®¤è¯ä¸­é—´ä»¶å®ä¾‹

**middleware.User ç»“æ„ï¼š**
```go
type User struct {
    UserID   int64
    Username string
    Role      string
}
```

**ä½¿ç”¨ç¤ºä¾‹ï¼š**
```go
import "todolist/internal/interfaces/http/middleware"

func GetCurrentUserHandler(ctx context.Context, req Empty) (UserResponse, error) {
    // è·å–å½“å‰ç”¨æˆ·
    user, ok := middleware.GetDataFromContext(ctx)
    if !ok {
        return UserResponse{}, errors.New("unauthorized")
    }

    // ä½¿ç”¨ç”¨æˆ·ä¿¡æ¯
    userID := user.UserID
    username := user.Username

    // ä¸šåŠ¡é€»è¾‘
    return userService.GetByID(ctx, userID)
}
```

è¯¦ç»†æ–‡æ¡£ï¼š[JWT_AUTHENTICATION.md](docs/JWT_AUTHENTICATION.md)

## æ¶æ„è®¾è®¡æ–‡æ¡£

é¡¹ç›®åŒ…å«è¯¦ç»†çš„æ¶æ„è®¾è®¡æ–‡æ¡£ï¼š

| æ–‡æ¡£ | è¯´æ˜ |
|------|------|
| [CONVENTIONS.md](CONVENTIONS.md) | **é¡¹ç›®å¼€å‘è§„èŒƒï¼ˆå¿…è¯»ï¼‰** |
| [JWT_AUTHENTICATION.md](docs/JWT_AUTHENTICATION.md) | JWT è®¤è¯æœºåˆ¶å®Œæ•´æŒ‡å— |
| [JWT_QUICK_START.md](docs/JWT_QUICK_START.md) | JWT å¿«é€Ÿå‚è€ƒ |
| [DTO_ARCHITECTURE.md](docs/DTO_ARCHITECTURE.md) | DTO æ¶æ„è®¾è®¡ |
| [DTO_LOCATION_REFACTOR.md](docs/DTO_LOCATION_REFACTOR.md) | DTO é‡æ„è¯´æ˜ |
| [APPLICATION_LAYER_IMPROVEMENTS.md](docs/APPLICATION_LAYER_IMPROVEMENTS.md) | åº”ç”¨å±‚ä¼˜åŒ– |

## å¼€å‘è§„èŒƒ

é¡¹ç›®éµå¾ªç»Ÿä¸€çš„å¼€å‘è§„èŒƒï¼Œè¯¦è§ [CONVENTIONS.md](CONVENTIONS.md)ï¼ŒåŒ…æ‹¬ï¼š

- **æ¶æ„æ¦‚è§ˆ**ï¼šDDDåˆ†å±‚æ¶æ„è¯´æ˜
- **é”™è¯¯å¤„ç†è§„èŒƒ**ï¼šé¢†åŸŸé”™è¯¯ç±»å‹å®šä¹‰å’ŒHTTPçŠ¶æ€ç æ˜ å°„
- **æ—¥å¿—è§„èŒƒ**ï¼šç»“æ„åŒ–æ—¥å¿—ä½¿ç”¨æŒ‡å—
- **DDDè®¾è®¡è§„èŒƒ**ï¼šé¢†åŸŸé©±åŠ¨è®¾è®¡æœ€ä½³å®è·µ
- **ä»£ç ç»„ç»‡è§„èŒƒ**ï¼šæ–‡ä»¶å’Œç›®å½•ç»„ç»‡çº¦å®š

### æ—¥å¿—è§„èŒƒ

é¡¹ç›®ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—ï¼Œéµå¾ª [logger/CONVENTIONS.md](internal/pkg/logger/CONVENTIONS.md)ï¼š

```go
import applogger "todolist/internal/pkg/logger"

// è®°å½•æ—¥å¿—
applogger.Info("ç”¨æˆ·æ³¨å†ŒæˆåŠŸ",
    applogger.Int64("user_id", userID),
    applogger.String("username", username),
    applogger.Duration("duration_ms", duration))

// å¸¦ä¸Šä¸‹æ–‡çš„æ—¥å¿—
applogger.InfoContext(ctx, "å¼€å§‹å¤„ç†è¯·æ±‚",
    applogger.String("path", r.URL.Path))
```

### DDD è®¾è®¡åŸåˆ™

1. **é¢†åŸŸå±‚**ï¼šçº¯ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¾èµ–åŸºç¡€è®¾æ–½
2. **åº”ç”¨å±‚**ï¼šç”¨ä¾‹ç¼–æ’ï¼Œæ¥æ”¶åŸå§‹å€¼ï¼Œè¿”å› DTO
3. **æ¥å£å±‚**ï¼šHTTP å¤„ç†ï¼Œä½¿ç”¨åº”ç”¨å±‚æœåŠ¡
4. **åŸºç¡€è®¾æ–½å±‚**ï¼šå®ç°ä»“å‚¨æ¥å£ï¼Œå¯¹æ¥å¤–éƒ¨æœåŠ¡

### åˆ†å±‚ä¾èµ–

```
Handler â†’ Application â†’ Domain â†’ Infrastructure
  â†“          â†“           â†“          â†“
 HTTP       Use Case    Business   Data Access
```

**ä¾èµ–æ–¹å‘**ï¼šå¤–å±‚ä¾èµ–å†…å±‚ï¼Œå†…å±‚ä¸ä¾èµ–å¤–å±‚

## æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒå®ä½“

- **usersï¼ˆç”¨æˆ·ï¼‰**ï¼šè´¦æˆ·ä¿¡æ¯ã€è®¤è¯çŠ¶æ€
- **daily_notesï¼ˆæ¯æ—¥ç¬”è®°ï¼‰**ï¼šç”¨æˆ·ç¬”è®°
- **todosï¼ˆå¾…åŠäº‹é¡¹ï¼‰**ï¼šå…³è”ç¬”è®°çš„å¾…åŠ
- **notesï¼ˆå¤‡æ³¨ï¼‰**ï¼šå¾…åŠäº‹é¡¹çš„å¤‡æ³¨

**ER å›¾ï¼š** [docs/arch/er.puml](docs/arch/er.puml)

### æ•°æ®åº“è¿ç§»

```bash
# è¿è¡Œè¿ç§»
go run scripts/migrate.go

# æŸ¥çœ‹è¿ç§»è„šæœ¬
ls internal/infrastructure/persistence/migrations/
```

## å¼€å‘çŠ¶æ€

### å·²å®Œæˆ âœ…

- [x] é¡¹ç›®ç»“æ„æ­å»º
- [x] DDD åˆ†å±‚æ¶æ„
- [x] HTTP åŸºç¡€æ¡†æ¶
- [x] å¥åº·æ£€æŸ¥æ¥å£
- [x] ç»“æ„åŒ–æ—¥å¿—ç»„ä»¶
- [x] é”™è¯¯å¤„ç†æœºåˆ¶ï¼ˆdomainerrï¼‰
- [x] é…ç½®ç®¡ç†ï¼ˆç¯å¢ƒå˜é‡ï¼‰
- [x] ç”¨æˆ·é¢†åŸŸæ¨¡å‹
  - [x] ç”¨æˆ·å®ä½“ï¼ˆEntityï¼‰
  - [x] å€¼å¯¹è±¡ï¼ˆEmail, Password, Usernameï¼‰
  - [x] é¢†åŸŸé”™è¯¯å®šä¹‰
  - [x] é¢†åŸŸæœåŠ¡ï¼ˆUserServiceï¼‰
  - [x] ä»“å‚¨æ¥å£ï¼ˆRepositoryï¼‰
- [x] ç”¨æˆ·ä»“å‚¨å®ç°ï¼ˆMySQLï¼‰
- [x] å¯†ç å“ˆå¸Œï¼ˆbcryptï¼‰
- [x] JWT Token å·¥å…·
- [x] è®¤è¯ä¸­é—´ä»¶
- [x] è·¯ç”±æ¨¡å—
- [x] åº”ç”¨å±‚æœåŠ¡ï¼ˆApplicationï¼‰
- [x] DTO æ¶æ„
- [x] æ•°æ®åº“è¿æ¥å’Œé…ç½®
- [x] ç”¨æˆ·æ³¨å†Œ/ç™»å½•æ¥å£
- [x] æ¯æ—¥ç¬”è®°åŠŸèƒ½
  - [x] æ¯æ—¥ç¬”è®°å®ä½“
  - [x] æ¯æ—¥ç¬”è®°æœåŠ¡
  - [x] æ¯æ—¥ç¬”è®°ä»“å‚¨
  - [x] æ¯æ—¥ç¬”è®°åº”ç”¨æœåŠ¡
  - [x] æ¯æ—¥ç¬”è®°æ¥å£
- [x] æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
- [x] Docker éƒ¨ç½²é…ç½®
- [x] é¡¹ç›®å¼€å‘è§„èŒƒæ–‡æ¡£ï¼ˆCONVENTIONS.mdï¼‰

### è¿›è¡Œä¸­ ğŸš§

- [ ] å¾…åŠäº‹é¡¹é¢†åŸŸæ¨¡å‹
- [ ] Markdown å¯¼å‡ºåŠŸèƒ½
- [ ] å•å…ƒæµ‹è¯•
- [ ] API æ–‡æ¡£å®Œå–„

### å¾…è§„åˆ’ ğŸ“‹

- [ ] Docker éƒ¨ç½²ä¼˜åŒ–
- [ ] CI/CD Pipeline
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] ç›‘æ§å’Œå‘Šè­¦
- [ ] é“¾è·¯è¿½è¸ª

## æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šåŒ…çš„æµ‹è¯•
go test ./internal/domain/user/...

# æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡
go test -cover ./...
```

## é…ç½®

### ç¯å¢ƒå˜é‡

é¡¹ç›®ä½¿ç”¨ç¯å¢ƒå˜é‡è¿›è¡Œé…ç½®ï¼Œæ¨èä½¿ç”¨ `.env` æ–‡ä»¶æˆ–ç›´æ¥è®¾ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼š

| å˜é‡å | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `SERVER_PORT` | æœåŠ¡ç«¯å£ | 8080 |
| `MYSQL_HOST` | MySQLä¸»æœº | localhost |
| `MYSQL_PORT` | MySQLç«¯å£ | 3307 |
| `MYSQL_DB` | æ•°æ®åº“åç§° | todolist |
| `MYSQL_USER` | MySQLç”¨æˆ· | root |
| `MYSQL_PASSWORD` | MySQLå¯†ç  | 123456 |
| `MYSQL_MAX_OPEN_CONNS` | æœ€å¤§è¿æ¥æ•° | 100 |
| `MYSQL_MAX_IDLE_CONNS` | æœ€å¤§ç©ºé—²è¿æ¥æ•° | 10 |
| `JWT_SECRET_KEY` | JWTå¯†é’¥ï¼ˆè‡³å°‘32å­—ç¬¦ï¼‰ | - |
| `JWT_EXPIRE_DURATION` | Tokenè¿‡æœŸæ—¶é—´ | 24h |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | info |

### å¿«é€Ÿå¯åŠ¨

```bash
# æ–¹å¼1ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡æ–‡ä»¶
cat > .env << EOF
MYSQL_HOST=localhost
MYSQL_PORT=3307
MYSQL_DB=todolist
MYSQL_USER=root
MYSQL_PASSWORD=123456
JWT_SECRET_KEY=your-secret-key-at-least-32-characters-long
EOF

# æ–¹å¼2ï¼šç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡
export MYSQL_HOST=localhost
export MYSQL_PORT=3307
export MYSQL_DB=todolist
export MYSQL_USER=root
export MYSQL_PASSWORD=123456
export JWT_SECRET_KEY=your-secret-key-at-least-32-characters-long

# å¯åŠ¨æœåŠ¡
go run cmd/server/main.go
```

### Docker Compose é…ç½®

ä½¿ç”¨ `docker-compose.yml` å¯ä»¥è‡ªåŠ¨é…ç½®ç¯å¢ƒå˜é‡ï¼š

```yaml
services:
  mysql:
    environment:
      MYSQL_ROOT_PASSWORD: 123456
      MYSQL_DATABASE: todolist
    ports:
      - "3307:3306"  # æ˜ å°„åˆ°ä¸»æœº3307ç«¯å£é¿å…å†²çª
```

## å¸¸è§é—®é¢˜

### 1. å¦‚ä½•æ·»åŠ æ–°çš„æ¥å£ï¼Ÿ

```go
// 1. åœ¨ handler ä¸­å®šä¹‰å¤„ç†å™¨
func NewTodoHandler(ctx context.Context, req request.CreateTodoRequest) (response.TodoResponse, error) {
    return todoAppService.CreateTodo(ctx, req.Title, req.Content)
}

// 2. åœ¨ routes.go ä¸­æ³¨å†Œè·¯ç”±
mux.Handle("POST /api/todos",
    auth.Authenticate(handler.Wrap(NewTodoHandler)))
```

### 2. å¦‚ä½•ä½¿ç”¨ JWT è®¤è¯ï¼Ÿ

```go
// 1. ç™»å½•è·å– Token
POST /api/auth/login
{
  "email": "user@example.com",
  "password": "password"
}

// 2. ä½¿ç”¨ Token è®¿é—®å—ä¿æŠ¤æ¥å£
GET /api/users/me
Headers: Authorization: Bearer <token>
```

### 3. å¦‚ä½•è·å–å½“å‰ç”¨æˆ·ï¼Ÿ

```go
import "todolist/internal/interfaces/http/middleware"

func Handler(ctx context.Context) {
    user, ok := middleware.GetDataFromContext(ctx)
    if !ok {
        // å¤„ç†æœªè®¤è¯æƒ…å†µ
        return
    }

    userID := user.UserID
    username := user.Username
    role := user.Role
    // ...
}
```

### 4. å¦‚ä½•æ·»åŠ è§’è‰²æƒé™ï¼Ÿ

```go
// åœ¨è·¯ç”±ä¸­ä½¿ç”¨ RequireRole ä¸­é—´ä»¶
mux.Handle("/api/admin/users",
    auth.Authenticate(
        auth.RequireRole("admin")(
            handler.Wrap(AdminHandler))))

// åœ¨ Handler ä¸­æ£€æŸ¥
user, ok := middleware.GetDataFromContext(ctx)
if !ok || user.Role != "admin" {
    return errors.New("permission denied")
}
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## è®¸å¯è¯

[MIT License](LICENSE)

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€ï¼š[GitHub Repository]
- é—®é¢˜åé¦ˆï¼š[Issues]

---

**æœ€åæ›´æ–°ï¼š** 2026-01-20
**æ–‡æ¡£ç‰ˆæœ¬ï¼š** 1.1.0
